# Spec: Dependencies Lock File

## ADDED Requirements

### Requirement: package-lock.json MUST be committed to repository
**Status**: New  
**Priority**: P0 (Critical)  
**Category**: CI/CD Infrastructure

The `package-lock.json` file SHALL be added to git tracking, ensuring exact dependency versions are reproducible across all environments (local development, CI/CD, team members).

#### Scenario: GitHub Actions can locate package-lock.json
- GitHub Actions workflow SHALL start and check for lock file in repository root
- The lock file SHALL exist at path: `package-lock.json`
- GitHub Actions `setup-node@v4` with `cache: 'npm'` SHALL successfully find the file
- The npm caching layer SHALL be populated from lock file

#### Scenario: npm ci installs exact versions from lock file
- When CI workflow runs `npm ci` (clean install), it SHALL use `package-lock.json` to install exact pinned versions
- No dependency resolution SHALL happen (deterministic installation)
- Installation SHALL succeed without warnings or version conflicts

#### Scenario: Lock file reflects current project dependencies
- File SHALL contain all dependencies from `package.json` (playwright, eslint, typescript, etc.)
- All transitive dependencies SHALL be pinned to specific versions
- Integrity checksums for each package SHALL be included

---

### Requirement: GitHub Actions workflow MUST access npm cache with lock file present
**Status**: New  
**Priority**: P0 (Critical)  
**Category**: CI/CD Infrastructure

The workflow configuration in `.github/workflows/ci.yml` already uses `cache: 'npm'`. With the lock file committed to the repository, this caching layer SHALL function correctly to improve CI performance and ensure deterministic builds.

#### Scenario: npm cache is populated on first run
- First CI run: lock file SHALL exist, npm SHALL download and cache dependencies
- Cache SHALL be stored in GitHub Actions cache storage
- Subsequent runs SHALL benefit from cache hits (faster builds)

#### Scenario: Cache is invalidated when lock file changes
- If `package-lock.json` changes (dependency update), cache key SHALL be updated
- New dependencies SHALL be fetched and cached
- Old cache entries SHALL be discarded

---

## MODIFIED Requirements

There SHALL be no modified requirements. This is a new spec with no previously existing requirements.

---

## REMOVED Requirements

There SHALL be no removed requirements. This is a new spec with no previously existing requirements.

---

## Implementation Notes

- **File**: `package-lock.json` (root of repository)
- **Size**: ~65KB (typical for npm projects with ~20 dependencies)
- **Syntax**: JSON format (standard npm format)
- **Tool**: Generated by `npm install` or `npm ci`
- **Review**: Lock file should be reviewed in PR to verify no unexpected version changes

## Related Specs

- CI/CD Pipeline configuration (`.github/workflows/ci.yml`)
- Node.js tooling (18.x LTS)
- npm package manager
